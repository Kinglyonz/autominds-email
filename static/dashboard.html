<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AutoMinds — Command Center</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Plus+Jakarta+Sans:wght@500;600;700;800&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/static/dashboard.css">
</head>
<body>
<canvas id="bg-canvas"></canvas>

<div class="app-shell">
<!-- Sidebar -->
<aside class="sidebar">
    <div class="brand">
        <div class="brand-logo"><span>A</span></div>
        <div>
            <div class="brand-text">AutoMinds</div>
            <div class="brand-tag">Command Center</div>
        </div>
    </div>

    <div class="nav-label">Your AMIs</div>
    <nav id="ami-nav">
        <div class="nav-item active" data-panel="cortex" onclick="switchPanel('cortex')">
            <div class="nav-icon cortex"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#3B82F6" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg></div>
            <div><div class="nav-name">Cortex</div><div class="nav-sub">Knowledge Engine</div></div>
            <span class="badge badge-live">Live</span>
        </div>
        <div class="nav-item" data-panel="inbox" onclick="switchPanel('inbox')">
            <div class="nav-icon inbox"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#22C55E" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M22 7l-10 7L2 7"/></svg></div>
            <div><div class="nav-name">Inbox Pilot</div><div class="nav-sub">Email Intelligence</div></div>
            <span class="badge badge-live">Live</span>
        </div>
        <div class="nav-item" data-panel="echo" onclick="switchPanel('echo')">
            <div class="nav-icon echo"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#A855F7" stroke-width="2"><path d="M12 3a9 9 0 019 9 9 9 0 01-9 9"/><path d="M12 7a5 5 0 015 5 5 5 0 01-5 5"/><circle cx="12" cy="12" r="1"/></svg></div>
            <div><div class="nav-name">Echo</div><div class="nav-sub">Digital Clone</div></div>
            <span class="badge badge-soon">Soon</span>
        </div>
    </nav>

    <div class="sidebar-bottom">
        <div class="user-row">
            <div class="user-avatar" id="user-avatar">?</div>
            <div>
                <div class="user-name" id="user-display-name">—</div>
                <div class="user-email" id="user-display-email">—</div>
            </div>
        </div>
        <button class="sign-out" onclick="logout()">Sign Out</button>
    </div>
</aside>

<!-- Main -->
<main class="main">
    <!-- Top Bar -->
    <header class="topbar">
        <div class="topbar-left">
            <div class="topbar-icon" id="topbar-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3B82F6" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg></div>
            <div>
                <h1 class="topbar-title" id="topbar-title">Cortex</h1>
                <p class="topbar-sub" id="topbar-sub">Chat with your documents. Powered by RAG.</p>
            </div>
        </div>
        <div class="status-pill"><span class="pulse-dot"></span>Online</div>
    </header>

    <!-- Panel: Cortex -->
    <div id="panel-cortex" class="panel">
        <div class="index-bar">
            <input id="folder-id-input" type="text" placeholder="Paste Google Drive Folder ID to index..." class="input-field">
            <button onclick="indexDocuments()" id="index-btn" class="btn-glow">Index</button>
            <span id="index-status" class="idx-status"></span>
        </div>
        <div id="chat-messages" class="chat-area">
            <div class="msg msg-ai">
                <div class="msg-header"><span class="msg-label ai-label">⚡ Cortex</span></div>
                <div class="msg-body">Welcome to <strong>Cortex</strong> — your knowledge engine.<br><br>1. Paste a <strong>Google Drive Folder ID</strong> above and click <strong>Index</strong>.<br>2. Once indexed, ask me anything below.<br><br>I'll search your knowledge base and answer with full context.</div>
            </div>
        </div>
        <div class="chat-bar">
            <div class="chat-input-wrap">
                <input id="chat-input" type="text" placeholder="Ask Cortex a question..." class="chat-input" onkeydown="if(event.key==='Enter')sendMessage()">
                <button class="send-btn" onclick="sendMessage()"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></button>
            </div>
        </div>
    </div>

    <!-- Panel: Inbox Pilot -->
    <div id="panel-inbox" class="panel hidden">
        <!-- Inbox sub-tabs -->
        <div class="inbox-tabs">
            <button class="inbox-tab active" data-tab="emails" onclick="switchInboxTab('emails')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M22 7l-10 7L2 7"/></svg>
                Inbox <span class="tab-count" id="email-count">—</span>
            </button>
            <button class="inbox-tab" data-tab="briefing" onclick="switchInboxTab('briefing')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
                Briefing
            </button>
            <button class="inbox-tab" data-tab="drafts" onclick="switchInboxTab('drafts')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                Drafts <span class="tab-count" id="draft-count">—</span>
            </button>
            <button class="inbox-tab" data-tab="agent" onclick="switchInboxTab('agent')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/></svg>
                Agent
            </button>
            <div class="tab-actions">
                <button class="btn-refresh" onclick="refreshInbox()" title="Refresh">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 11-2.12-9.36L23 10"/></svg>
                </button>
            </div>
        </div>

        <!-- Sub-tab: Emails -->
        <div id="inbox-emails" class="inbox-content active">
            <div id="email-list" class="email-list">
                <div class="inbox-loading" id="email-loading">
                    <div class="loader-ring"></div>
                    <span>Loading your inbox...</span>
                </div>
            </div>
            <!-- Email detail view (hidden by default) -->
            <div id="email-detail" class="email-detail hidden">
                <button class="btn-back" onclick="closeEmailDetail()">← Back to inbox</button>
                <div id="email-detail-content"></div>
            </div>
        </div>

        <!-- Sub-tab: Briefing -->
        <div id="inbox-briefing" class="inbox-content">
            <div id="briefing-content" class="briefing-content">
                <div class="inbox-loading" id="briefing-loading">
                    <div class="loader-ring"></div>
                    <span>Generating your briefing...</span>
                </div>
            </div>
        </div>

        <!-- Sub-tab: Drafts -->
        <div id="inbox-drafts" class="inbox-content">
            <div id="drafts-list" class="drafts-list">
                <div class="inbox-loading" id="drafts-loading">
                    <div class="loader-ring"></div>
                    <span>Loading drafts...</span>
                </div>
            </div>
        </div>

        <!-- Sub-tab: Agent -->
        <div id="inbox-agent" class="inbox-content">
            <div class="agent-panel">
                <div class="agent-status-card" id="agent-status-card">
                    <div class="agent-header">
                        <div class="agent-icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#22C55E" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v2m0 18v2m-9-11h2m18 0h2m-3.64-6.36l-1.42 1.42M6.34 17.66l-1.42 1.42m0-12.73l1.42 1.42m11.31 11.31l1.42 1.42"/></svg></div>
                        <div>
                            <h3>Autonomous Agent</h3>
                            <p class="agent-desc">Scans your inbox, drafts replies, and creates tasks automatically.</p>
                        </div>
                    </div>
                    <div class="agent-stats" id="agent-stats">
                        <div class="stat-item"><span class="stat-label">Status</span><span class="stat-value" id="agent-enabled">—</span></div>
                        <div class="stat-item"><span class="stat-label">Last Run</span><span class="stat-value" id="agent-last-run">—</span></div>
                        <div class="stat-item"><span class="stat-label">Emails Processed</span><span class="stat-value" id="agent-processed">—</span></div>
                    </div>
                    <button class="btn-glow green agent-btn" onclick="runAgentNow()" id="run-agent-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                        Run Agent Now
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Panel: Echo -->
    <div id="panel-echo" class="panel hidden">
        <div class="center-panel">
            <div class="feature-card echo-glow">
                <div class="card-icon echo-icon"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#A855F7" stroke-width="1.5"><path d="M12 3a9 9 0 019 9 9 9 0 01-9 9"/><path d="M12 7a5 5 0 015 5 5 5 0 01-5 5"/><circle cx="12" cy="12" r="1"/></svg></div>
                <h3>Echo</h3>
                <p>Your digital clone — trained on your writing style, knowledge, and preferences. Echo responds like you.</p>
                <div class="tags">
                    <span class="tag tag-purple">Persona Engine</span>
                    <span class="tag tag-purple">Voice Matching</span>
                    <span class="tag tag-purple">Context Memory</span>
                    <span class="tag tag-purple">Multi-Channel</span>
                </div>
                <div class="coming-badge">◆ Coming Soon</div>
            </div>
        </div>
    </div>
</main>
</div>

<script src="/static/dashboard.js"></script>
</body>
</html>
